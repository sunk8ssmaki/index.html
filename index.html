<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Romantic Fireworks Page</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#ffd1dc,#ffeef3);
  height:100vh;
  overflow:hidden;
  transition:filter 0.8s ease;
}

/* ===== CANVAS ===== */
canvas{
  position:absolute;
  top:0;left:0;
  width:100%;height:100%;
}

/* ===== MESSAGE AREA ===== */
#messageBox{
  position:absolute;
  bottom:5%;
  left:50%;
  transform:translateX(-50%);
  font-size:1.8rem;
  text-align:center;
  color:#fff;
  text-shadow:0 0 10px rgba(0,0,0,0.6);
  padding:20px;
}

/* ===== BUTTONS ===== */
.buttonBox{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  display:flex;
  flex-direction:column;
  gap:15px;
}
button{
  padding:12px 25px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  font-size:1.2rem;
  background:#ff7aa2;
  color:white;
  transition:0.3s;
}
button:hover{background:#ff4d85}

/* ===== BLUR EFFECT ===== */
.blur-active{
  filter:blur(10px);
  transition:filter 0.8s ease;
}
.blur-remove{
  filter:blur(0px);
  transition:filter 0.8s ease;
}
</style>
</head>
<body class="blur-remove">

<canvas id="canvas"></canvas>

<div id="messageBox">ðŸ’— This moment is for you ðŸ’—</div>

<div class="buttonBox">
  <button id="continueBtn">Continue</button>
  <button id="backBtn">Back to Start</button>
</div>

<script>
// CANVAS SETUP
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

// RESIZE
addEventListener("resize",()=>{
  canvas.width = innerWidth;
  canvas.height = innerHeight;
});

// PARTICLES & ROCKETS
let rockets = [];
let particles = [];

class Rocket{
  constructor(side){
    this.x = side==="left" ? innerWidth*0.2 : innerWidth*0.8;
    this.y = innerHeight;
    this.speed = Math.random()*3+5;
    this.color = "white";
  }
  update(){
    this.y -= this.speed;
    if(this.y < innerHeight*0.4){
      createExplosion(this.x,this.y);
      rockets.splice(rockets.indexOf(this),1);
    }
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,3,0,Math.PI*2);
    ctx.fillStyle=this.color;
    ctx.fill();
  }
}

class HighlightRocket extends Rocket{
  update(){
    this.y -= this.speed;
    if(this.y < innerHeight*0.35){
      createHighlightExplosion(this.x,this.y);
      rockets.splice(rockets.indexOf(this),1);
    }
  }
}

// EXPLOSION PARTICLES
function createExplosion(x,y){
  for(let i=0;i<50;i++){
    particles.push({
      x,y,
      angle:Math.random()*Math.PI*2,
      speed:Math.random()*5+1,
      life:50,
      color:`hsl(${Math.random()*360},100%,60%)`
    });
  }
}
function createHighlightExplosion(x,y){
  for(let i=0;i<80;i++){
    particles.push({
      x,y,
      angle:Math.random()*Math.PI*2,
      speed:Math.random()*6+2,
      life:60,
      color:`hsl(${Math.random()*360},100%,80%)`
    });
  }
}

// WAIT UNTIL FINISH SYSTEM (smooth)
let waitingForFinish = false;
function checkIfClear(){
  if(rockets.length===0 && particles.length===0){
    waitingForFinish=false;
    setTimeout(()=>{ launchBatch(); },700); 
  } else {
    requestAnimationFrame(checkIfClear);
  }
}

function launchBatch(){
  if(waitingForFinish) return;
  waitingForFinish = true;

  rockets.push(new Rocket("left"));
  rockets.push(new Rocket("left"));
  rockets.push(new Rocket("right"));
  rockets.push(new Rocket("right"));
  rockets.push(new HighlightRocket("left"));
  rockets.push(new HighlightRocket("right"));

  requestAnimationFrame(checkIfClear);
}
launchBatch();

// ANIMATION LOOP
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  rockets.forEach(r=>{r.update();r.draw();});
  particles.forEach(p=>{
    p.x+=Math.cos(p.angle)*p.speed;
    p.y+=Math.sin(p.angle)*p.speed;
    p.life--;
    ctx.fillStyle=p.color;
    ctx.fillRect(p.x,p.y,3,3);
    if(p.life<=0) particles.splice(particles.indexOf(p),1);
  });

  requestAnimationFrame(animate);
}
animate();

/* ===== BLUR BUTTON CONTROL ===== */
const bg = document.body;
const continueBtn = document.getElementById("continueBtn");
const backBtn = document.getElementById("backBtn");

continueBtn.addEventListener("click",()=>{
  bg.classList.remove("blur-remove");
  bg.classList.add("blur-active");
});

backBtn.addEventListener("click",()=>{
  bg.classList.remove("blur-active");
  bg.classList.add("blur-remove");
});
</script>
</body>
</html>
